# ğŸ—ï¸ Architecture systÃ¨me â€” GLesCrocs

## Vue d'ensemble

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         UTILISATEURS                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                        â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                            â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚  CLIENT  â”‚                            â”‚  ADMIN   â”‚
    â”‚ (Mobile) â”‚                            â”‚ (Bureau) â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚                                        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                     HTTP / WebSocket
                          â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚    FRONTEND (React + Vite)      â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚  â”‚  Client View             â”‚   â”‚
         â”‚  â”‚  - Queue display         â”‚   â”‚
         â”‚  â”‚  - Menu & Cart           â”‚   â”‚
         â”‚  â”‚  - Order tracking        â”‚   â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚  â”‚  Admin Dashboard         â”‚   â”‚
         â”‚  â”‚  - Login                 â”‚   â”‚
         â”‚  â”‚  - Orders management     â”‚   â”‚
         â”‚  â”‚  - Menu editor           â”‚   â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â”‚                                  â”‚
         â”‚  Socket.IO Client                â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                 REST API / Socket
                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚    BACKEND (Node.js + Express)   â”‚
         â”‚                                  â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚  â”‚  Routes                  â”‚   â”‚
         â”‚  â”‚  - /api/auth (JWT)       â”‚   â”‚
         â”‚  â”‚  - /api/menu             â”‚   â”‚
         â”‚  â”‚  - /api/orders           â”‚   â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â”‚             â”‚                   â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚  â”‚  Services                â”‚   â”‚
         â”‚  â”‚  - Estimator (AI)        â”‚   â”‚
         â”‚  â”‚  - Queue manager         â”‚   â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â”‚             â”‚                   â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚  â”‚  Middleware              â”‚   â”‚
         â”‚  â”‚  - Auth (JWT verify)     â”‚   â”‚
         â”‚  â”‚  - Error handling        â”‚   â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â”‚                                  â”‚
         â”‚  Socket.IO Server                â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                   MySQL Driver
                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚    DATABASE (MySQL 8)            â”‚
         â”‚                                  â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚  â”‚  users                   â”‚   â”‚
         â”‚  â”‚  - id, email, password   â”‚   â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚  â”‚  menu_items              â”‚   â”‚
         â”‚  â”‚  - id, name, price       â”‚   â”‚
         â”‚  â”‚  - avg_prep_seconds      â”‚   â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚  â”‚  orders                  â”‚   â”‚
         â”‚  â”‚  - id, ticket_number     â”‚   â”‚
         â”‚  â”‚  - status, timestamps    â”‚   â”‚
         â”‚  â”‚  - estimated_wait_secondsâ”‚   â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚  â”‚  order_items             â”‚   â”‚
         â”‚  â”‚  - order_id, menu_item_idâ”‚   â”‚
         â”‚  â”‚  - quantity              â”‚   â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚  â”‚  order_events (logs)     â”‚   â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Flux de donnÃ©es

### 1. CrÃ©ation de commande (Client)

```
Client â†’ POST /api/orders
         â”‚
         â”œâ”€ Insert order (status: PENDING)
         â”œâ”€ Insert order_items
         â”œâ”€ Estimator calcul (AI)
         â”‚  â””â”€ Retourne estimated_wait_seconds
         â”œâ”€ Update order.estimated_wait_seconds
         â”‚
         â””â”€ Socket.io.emit('order_update')
                  â”‚
                  â””â”€â†’ Tous les clients connectÃ©s reÃ§oivent mise Ã  jour
```

### 2. Validation commande (Admin)

```
Admin â†’ POST /api/orders/:id/validate (avec JWT)
         â”‚
         â”œâ”€ VÃ©rifier token JWT (middleware)
         â”œâ”€ GÃ©nÃ©rer ticket_number (auto-increment)
         â”œâ”€ Update order (status: VALIDATED)
         â”œâ”€ Re-calculer estimation (backlog changÃ©)
         â”‚
         â””â”€ Socket.io.emit('queue_update')
                  â”‚
                  â””â”€â†’ File d'attente rafraÃ®chie partout
```

### 3. Marquage prÃªt/servi (Admin)

```
Admin â†’ POST /api/orders/:id/ready
         â”‚
         â”œâ”€ Update order (status: READY, ready_at: NOW())
         â”‚
         â””â”€ Socket.io.emit('queue_update')
                  â”‚
                  â””â”€â†’ Client voit "PrÃªt Ã  rÃ©cupÃ©rer" (fond vert)
```

## Estimateur IA â€” Pipeline

```
Order crÃ©Ã©e â†’ Estimator.estimateWaitSecondsForOrder(orderId)
                â”‚
                â”œâ”€ 1. RÃ©cupÃ©rer plats commande + avg_prep_seconds
                â”‚     temps_base = Î£(plat.avg_prep Ã— quantitÃ©)
                â”‚
                â”œâ”€ 2. Compter commandes devant
                â”‚     backlog_factor = 1 + (0.05 Ã— nb_devant)
                â”‚
                â”œâ”€ 3. Facteur service (heure)
                â”‚     if (12-14h || 19-22h) â†’ Ã—1.2
                â”‚
                â”œâ”€ 4. Diviser par postes parallÃ¨les
                â”‚     result = (base Ã— backlog Ã— service) Ã· 2
                â”‚
                â””â”€ 5. Min 120s, retour estimation
```

## Communication temps rÃ©el

### Socket.IO Events

```
Client                          Backend
  â”‚                               â”‚
  â”œâ”€ connect â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶
  â”‚                               â”‚
  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ connection â”€â”€â”€â”€â”€â”¤
  â”‚                               â”‚
  â”‚                            [Admin valide]
  â”‚                               â”‚
  â”‚â—€â”€â”€â”€â”€ queue_update â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                               â”‚
  â”œâ”€ fetch /api/orders/queue â”€â”€â”€â”€â–¶
  â”‚                               â”‚
  â”‚â—€â”€â”€â”€â”€ { currentServing, queue }â”¤
  â”‚                               â”‚
```

**Events Ã©mis par le backend** :
- `queue_update` : quand file change (validate/ready/served)
- `order_update` : quand commande crÃ©Ã©e (avec estimation)

## Stack dÃ©taillÃ©e

### Backend

```
Express.js (serveur HTTP)
â”œâ”€â”€ dotenv (config .env)
â”œâ”€â”€ cors (autoriser frontend)
â”œâ”€â”€ jsonwebtoken (auth admin)
â”œâ”€â”€ bcryptjs (hash passwords)
â”œâ”€â”€ mysql2/promise (connexion DB)
â””â”€â”€ socket.io (temps rÃ©el)
```

### Frontend

```
React 18 (UI)
â”œâ”€â”€ Vite (build tool)
â”œâ”€â”€ socket.io-client (temps rÃ©el)
â””â”€â”€ fetch API (REST calls)
```

### Base de donnÃ©es

```
MySQL 8 (WAMP)
â”œâ”€â”€ InnoDB engine
â”œâ”€â”€ Foreign keys (CASCADE)
â””â”€â”€ Indexes (status, ticket_number)
```

## Environnements

### DÃ©veloppement (local)

```
Frontend : http://localhost:5173
Backend  : http://localhost:4000
MySQL    : localhost:3306
```

### Production (exemple)

```
Frontend : https://username.github.io/GLesCrocs
Backend  : https://api.glescrocs.com (VPS/Render)
MySQL    : mysql.glescrocs.com:3306 (managed DB)
```

## SÃ©curitÃ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend                               â”‚
â”‚  - Pas de secrets                       â”‚
â”‚  - Token stockÃ© localStorage            â”‚
â”‚  - HTTPS only (prod)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
       JWT Token
           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Middleware JWT                 â”‚     â”‚
â”‚  â”‚ verify(token, JWT_SECRET)      â”‚     â”‚
â”‚  â”‚ âœ“ Valid â†’ req.user = payload   â”‚     â”‚
â”‚  â”‚ âœ— Invalid â†’ 401 Unauthorized   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Passwords                      â”‚     â”‚
â”‚  â”‚ bcrypt.hash(password, 10)      â”‚     â”‚
â”‚  â”‚ Stored: $2b$10$hash...         â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ScalabilitÃ© future

### Horizontal scaling backend

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Nginx   â”‚ (Load Balancer)
â”‚  Reverse â”‚
â”‚  Proxy   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
     â”‚      â”‚      â”‚      â”‚
  â”Œâ”€â”€â–¼â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”
  â”‚ API  â”‚ â”‚ API â”‚ â”‚ API â”‚ (instances multiples)
  â”‚ :4001â”‚ â”‚:4002â”‚ â”‚:4003â”‚
  â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”¬â”€â”€â”€â”€â”˜ â””â”¬â”€â”€â”€â”€â”˜
     â”‚      â”‚       â”‚
     â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”¬â”€â”€â”€â”˜
                â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
         â”‚ MySQL       â”‚
         â”‚ (replica)   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Socket.IO avec Redis** :

```javascript
import { createAdapter } from '@socket.io/redis-adapter';
import { createClient } from 'redis';

const pubClient = createClient({ host: 'localhost', port: 6379 });
const subClient = pubClient.duplicate();

io.adapter(createAdapter(pubClient, subClient));
```

Permet Ã  plusieurs instances backend de partager les events Socket.IO.

## Monitoring

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend    â”‚
â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Errors â”‚â”€â”€â”¼â”€â”€â†’ Sentry / LogRocket
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend     â”‚
â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Logs   â”‚â”€â”€â”¼â”€â”€â†’ PM2 logs / CloudWatch
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Metricsâ”‚â”€â”€â”¼â”€â”€â†’ Prometheus / Grafana
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Database    â”‚
â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Slow Q â”‚â”€â”€â”¼â”€â”€â†’ MySQL slow query log
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Diagramme de sÃ©quence : Commande complÃ¨te

```
Client       Frontend      Backend       Estimator     Database      Admin
  â”‚              â”‚             â”‚              â”‚            â”‚            â”‚
  â”œâ”€ Ajouter â”€â”€â”€â”€â–¶             â”‚              â”‚            â”‚            â”‚
  â”‚   plats      â”‚             â”‚              â”‚            â”‚            â”‚
  â”œâ”€ Commander â”€â”€â–¶             â”‚              â”‚            â”‚            â”‚
  â”‚              â”œâ”€ POST â”€â”€â”€â”€â”€â”€â–¶              â”‚            â”‚            â”‚
  â”‚              â”‚  /orders    â”‚              â”‚            â”‚            â”‚
  â”‚              â”‚             â”œâ”€ INSERT â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚
  â”‚              â”‚             â”‚   order      â”‚            â”‚            â”‚
  â”‚              â”‚             â”œâ”€ INSERT â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚
  â”‚              â”‚             â”‚   items      â”‚            â”‚            â”‚
  â”‚              â”‚             â”œâ”€ estimate â”€â”€â”€â–¶            â”‚            â”‚
  â”‚              â”‚             â”‚              â”œâ”€ SELECT â”€â”€â”€â–¶            â”‚
  â”‚              â”‚             â”‚              â”‚   items    â”‚            â”‚
  â”‚              â”‚             â”‚              â”œâ”€ SELECT â”€â”€â”€â–¶            â”‚
  â”‚              â”‚             â”‚              â”‚   backlog  â”‚            â”‚
  â”‚              â”‚             â”‚              â”œâ”€ Calcul â”€â”€â”€â”¤            â”‚
  â”‚              â”‚             â”‚â—€â”€ 540s â”€â”€â”€â”€â”€â”€â”¤            â”‚            â”‚
  â”‚              â”‚             â”œâ”€ UPDATE â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚
  â”‚              â”‚             â”‚   estimation â”‚            â”‚            â”‚
  â”‚              â”‚â—€â”€ 200 OK â”€â”€â”€â”¤              â”‚            â”‚            â”‚
  â”‚              â”‚   {id, 540s}â”‚              â”‚            â”‚            â”‚
  â”‚â—€â”€ "~9 min" â”€â”€â”¤             â”‚              â”‚            â”‚            â”‚
  â”‚              â”‚             â”‚              â”‚            â”‚            â”‚
  â”‚              â”‚             â”‚              â”‚            â”‚      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
  â”‚              â”‚             â”‚              â”‚            â”‚      â”‚ Valide    â”‚
  â”‚              â”‚             â”‚              â”‚            â”‚      â”‚ commande  â”‚
  â”‚              â”‚             â”‚              â”‚            â”‚      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
  â”‚              â”‚             â”‚â—€â”€ POST /validate â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚              â”‚             â”œâ”€ ticket â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚
  â”‚              â”‚             â”œâ”€ emit â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚            â”‚
  â”‚              â”‚             â”‚  queue_updateâ”‚            â”‚            â”‚
  â”‚              â”‚â—€â”€ EVENT â”€â”€â”€â”€â”¤              â”‚            â”‚            â”‚
  â”‚â—€â”€ Mise â”€â”€â”€â”€â”€â”€â”¤             â”‚              â”‚            â”‚            â”‚
  â”‚   Ã  jour     â”‚             â”‚              â”‚            â”‚            â”‚
  â”‚              â”‚             â”‚              â”‚            â”‚      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
  â”‚              â”‚             â”‚              â”‚            â”‚      â”‚ PrÃªt      â”‚
  â”‚              â”‚             â”‚              â”‚            â”‚      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
  â”‚              â”‚             â”‚â—€â”€ POST /ready â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚              â”‚             â”œâ”€ UPDATE â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚
  â”‚              â”‚             â”œâ”€ emit â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚            â”‚
  â”‚              â”‚â—€â”€ EVENT â”€â”€â”€â”€â”¤              â”‚            â”‚            â”‚
  â”‚â—€â”€ ğŸ‰ PrÃªt! â”€â”€â”¤             â”‚              â”‚            â”‚            â”‚
  â–¼              â–¼             â–¼              â–¼            â–¼            â–¼
```

## Conclusion

Architecture **3-tiers classique** :
1. **PrÃ©sentation** : React (client + admin)
2. **Logique** : Express + Socket.IO (API + temps rÃ©el)
3. **DonnÃ©es** : MySQL (persistence)

**Points forts** :
- SÃ©paration claire des responsabilitÃ©s
- Temps rÃ©el via WebSocket (Socket.IO)
- Estimation intelligente (IA simple)
- Extensible (ML, stats, paiements)
- CI/CD automatisÃ© (GitHub Actions)
